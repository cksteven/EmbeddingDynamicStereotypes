d3 = d3[d3$sex == 1,] %>% select(-sex)
d3 = d3[d3$sex == 1,] %>% select(-sex, -x)
d3 = d3[d3$sex == 1,] %>% select(-sex, -x)
d3 = d3[d3$sex == 1,] %>% select(-sex) %>% select(-x)
d3 = read.csv("IPUMS.csv") %>% janitor::clean_names()
d3 = d3[d3$sex == 1,] %>% select(-sex) %>% select(-x)
d3 = read.csv("IPUMS.csv") %>% janitor::clean_names()
d3 = d3[d3$sex == 1,] %>% select(-sex, -x)
d3 = d3[d3$sex == 1,] %>% select(-sex, -x) %>% rename(occup = single_words)
d3 = read.csv("IPUMS.csv") %>% janitor::clean_names()
d3 = d3[d3$sex == 1,] %>% select(-sex, -x) %>% rename(occup = single_words)
d3 = d3[d3$occup %in% filtered_occups,]
occup_stats = d3.T
occup_stats = t(d3)
View(occup_stats)
occup_stats = d3 %>% group_by(occup)
occup_stats
occup_stats = d3 %>% pivot_wider(occup)
occup_stats = d3 %>% pivot_wider(names_from = occup)
occup_stats = d3 %>% pivot_wider(names_from = occup,
values_from = percent
)
occup_stats = d3 %>% pivot_wider(
id_cols = year,
names_from = occup,
values_from = percent)
View(d2)
write.csv(occup_stats, "occup_stats.csv")
occup_stats = occup_stats[occup_stats$year %in% d$year,]
occup_stats$occup_m = rowMeans(occup_stats[,2:47])
?rowMeans
occup_stats$occup_m = rowMeans(occup_stats[,2:47], na.rm = T)
occup_na = c("dancer", "dentist", "designer", "gardener", "musician", "porter", "professor", "retired")
c("dancer", "dentist", "designer", "gardener", "musician", "porter", "professor", "retired")
?select
occup_stats = occup_stats %>% select(!all_of(occup_na))
occup_stats = occup_stats[occup_stats$year %in% d$year,]
occup_stats = d3 %>% pivot_wider(
id_cols = year,
names_from = occup,
values_from = percent)
occup_stats = occup_stats[occup_stats$year %in% d$year,]
occup_na = c("dancer", "dentist", "designer", "gardener", "musician", "porter", "professor", "retired")
occup_stats = occup_stats %>% select(!all_of(occup_na))
occup_stats$occup_m = rowMeans(occup_stats[,2:39], na.rm = T)
d = d %>% select(!all_of(occup_na))
View(d)
d$occup_m = rowMeans(d2[,2:39])
d$gss_m = d1$attitude
### mean ling gender bias
### together
ggplot(data=d, aes(x=year)) +
geom_line(aes(y = occup_m, color = "occup_m"))
res = ccf(d$occup_m, d$gss_m, lag = 10)
max_lags = c()
max_acfs = c()
for (occup in filtered_occups){
res = ccf(d[,occup], d$gss_m, lag = 10, plot=F)
res_df = do.call(rbind, Map(data.frame, lag=res$lag, acf=res$acf))
max_lag = res_df$lag[which.max(res_df$acf)]
max_acf = max(res_df$acf)
max_lags = append(max_lags, max_lag)
max_acfs = append(max_acfs, max_acf)
}
max_lags
filtered_occups = filtered_occups[!filtered_occups %in% occup_na]
for (occup in filtered_occups){
res = ccf(d[,occup], d$gss_m, lag = 10, plot=F)
res_df = do.call(rbind, Map(data.frame, lag=res$lag, acf=res$acf))
max_lag = res_df$lag[which.max(res_df$acf)]
max_acf = max(res_df$acf)
max_lags = append(max_lags, max_lag)
max_acfs = append(max_acfs, max_acf)
}
max_lags
mean(max_lags)
max_acfs
mean(max_acfs)
lag_df = do.call(rbind, Map(data.frame, occup=filtered_occups, max_lag=max_lags, max_acf=max_acfs))
filtered_occups
max_lags
max_lags = c()
max_acfs = c()
filtered_occups = filtered_occups[!filtered_occups %in% occup_na]
for (occup in filtered_occups){
res = ccf(d[,occup], d$gss_m, lag = 10, plot=F)
res_df = do.call(rbind, Map(data.frame, lag=res$lag, acf=res$acf))
max_lag = res_df$lag[which.max(res_df$acf)]
max_acf = max(res_df$acf)
max_lags = append(max_lags, max_lag)
max_acfs = append(max_acfs, max_acf)
}
max_lags
mean(max_lags)
max_acfs
mean(max_acfs)
lag_df = do.call(rbind, Map(data.frame, occup=filtered_occups, max_lag=max_lags, max_acf=max_acfs))
write.csv(lag_df, "lag_df.csv")
max_lags_2 = c()
max_acfs_2 = c()
for (occup in filtered_occups){
res = ccf(d[,occup], occup_stats[,occup], lag = 10, plot=F)
res_df = do.call(rbind, Map(data.frame, lag=res$lag, acf=res$acf))
max_lag = res_df$lag[which.max(res_df$acf)]
max_acf = max(res_df$acf)
max_lags_2 = append(max_lags_2, max_lag)
max_acfs_2 = append(max_acfs_2, max_acf)
}
max_lags
mean(max_lags)
max_acfs
mean(max_acfs)
max_lags_2
mean(max_lags_2)
max_acfs_2
mean(max_acfs_2)
lag_df_2 = do.call(rbind, Map(data.frame, occup=filtered_occups, max_lag=max_lags_2, max_acf=max_acfs_2))
write.csv(lag_df, "lag_df_2.csv")
max_lags_3 = c()
max_acfs_3 = c()
for (occup in filtered_occups){
res = ccf(occup_stats[,occup], d$occup_m, lag = 10, plot=F)
res_df = do.call(rbind, Map(data.frame, lag=res$lag, acf=res$acf))
max_lag = res_df$lag[which.max(res_df$acf)]
max_acf = max(res_df$acf)
max_lags_3 = append(max_lags_3, max_lag)
max_acfs_3 = append(max_acfs_3, max_acf)
}
max_lags_3
mean(max_lags_3)
max_acfs_3
mean(max_acfs_3)
lag_df_2 = do.call(rbind, Map(data.frame, occup=filtered_occups, max_lag=max_lags_3, max_acf=max_acfs_2))
lag_df_2 = do.call(rbind, Map(data.frame, occup=filtered_occups, max_lag=max_lags_3, max_acf=max_acfs_3))
lag_df_3 = do.call(rbind, Map(data.frame, occup=filtered_occups, max_lag=max_lags_3, max_acf=max_acfs_3))
write.csv(lag_df, "lag_df_3.csv")
max_lags = c()
max_acfs = c()
filtered_occups = filtered_occups[!filtered_occups %in% occup_na]
for (occup in filtered_occups){
res = ccf(d[,occup], d$gss_m, lag = 10, plot=F)
res_df = do.call(rbind, Map(data.frame, lag=res$lag, acf=res$acf))
max_lag = res_df$lag[which.max(res_df$acf)]
max_acf = max(res_df$acf)
max_lags = append(max_lags, max_lag)
max_acfs = append(max_acfs, max_acf)
}
max_lags
mean(max_lags)
max_acfs
mean(max_acfs)
lag_df = do.call(rbind, Map(data.frame, occup=filtered_occups, max_lag=max_lags, max_acf=max_acfs))
write.csv(lag_df, "lag_df.csv")
max_lags_2 = c()
max_acfs_2 = c()
for (occup in filtered_occups){
res = ccf(d[,occup], occup_stats[,occup], lag = 10, plot=F)
res_df = do.call(rbind, Map(data.frame, lag=res$lag, acf=res$acf))
max_lag = res_df$lag[which.max(res_df$acf)]
max_acf = max(res_df$acf)
max_lags_2 = append(max_lags_2, max_lag)
max_acfs_2 = append(max_acfs_2, max_acf)
}
max_lags_2
mean(max_lags_2)
max_acfs_2
mean(max_acfs_2)
lag_df_2 = do.call(rbind, Map(data.frame, occup=filtered_occups, max_lag=max_lags_2, max_acf=max_acfs_2))
write.csv(lag_df, "lag_df_2.csv")
max_lags_3 = c()
max_acfs_3 = c()
for (occup in filtered_occups){
res = ccf(occup_stats[,occup], d$occup_m, lag = 10, plot=F)
res_df = do.call(rbind, Map(data.frame, lag=res$lag, acf=res$acf))
max_lag = res_df$lag[which.max(res_df$acf)]
max_acf = max(res_df$acf)
max_lags_3 = append(max_lags_3, max_lag)
max_acfs_3 = append(max_acfs_3, max_acf)
}
max_lags_3
mean(max_lags_3)
max_acfs_3
mean(max_acfs_3)
lag_df_3 = do.call(rbind, Map(data.frame, occup=filtered_occups, max_lag=max_lags_3, max_acf=max_acfs_3))
write.csv(lag_df, "lag_df_3.csv")
mean(max_lags_3)
2/sqrt(18)
2/sqrt(18.5)
?alpha
names(occup_stats)
lag_df_3
mean(max_lags)
View(occup_stats)
View(occup_stats)
write.csv(occup_stats, "occup_stats.csv")
max_lags_3 = c()
max_acfs_3 = c()
for (occup in filtered_occups){
res = ccf(occup_stats[,occup], d$gss_m, lag = 10, plot=F)
res_df = do.call(rbind, Map(data.frame, lag=res$lag, acf=res$acf))
max_lag = res_df$lag[which.max(res_df$acf)]
max_acf = max(res_df$acf)
max_lags_3 = append(max_lags_3, max_lag)
max_acfs_3 = append(max_acfs_3, max_acf)
}
for (occup in filtered_occups){
res = ccf(occup_stats[,occup], d$gss_m, lag = 10, plot=F)
res_df = do.call(rbind, Map(data.frame, lag=res$lag, acf=res$acf))
max_lag = res_df$lag[which.max(res_df$acf)]
max_acf = max(res_df$acf)
max_lags_3 = append(max_lags_3, max_lag)
max_acfs_3 = append(max_acfs_3, max_acf)
}
max_lags_3
mean(max_lags_3)
max_acfs_3
mean(max_acfs_3)
lag_df_3 = do.call(rbind, Map(data.frame, occup=filtered_occups, max_lag=max_lags_3, max_acf=max_acfs_3))
write.csv(lag_df, "lag_df_3.csv")
max_lags_3 = c()
max_acfs_3 = c()
for (occup in filtered_occups){
res = ccf(occup_stats[,occup], d$gss_m, lag = 10, plot=F)
res_df = do.call(rbind, Map(data.frame, lag=res$lag, acf=res$acf))
max_lag = res_df$lag[which.max(res_df$acf)]
max_acf = max(res_df$acf)
max_lags_3 = append(max_lags_3, max_lag)
max_acfs_3 = append(max_acfs_3, max_acf)
}
max_lags_3
mean(max_lags_3)
max_acfs_3
mean(max_acfs_3)
lag_df_3 = do.call(rbind, Map(data.frame, occup=filtered_occups, max_lag=max_lags_3, max_acf=max_acfs_3))
write.csv(lag_df, "lag_df_3.csv")
mean(max_lags_3)
mean(max_lags_2)
mean(max_lags)
max_lags_3 = c()
max_acfs_3 = c()
for (occup in filtered_occups){
res = ccf(occup_stats[,occup], d$gss_m, lag = 10, plot=F)
res_df = do.call(rbind, Map(data.frame, lag=res$lag, acf=res$acf))
max_lag = res_df$lag[which.max(res_df$acf)]
max_acf = max(res_df$acf)
max_lags_3 = append(max_lags_3, max_lag)
max_acfs_3 = append(max_acfs_3, max_acf)
}
max_lags = c()
max_acfs = c()
filtered_occups = filtered_occups[!filtered_occups %in% occup_na]
for (occup in filtered_occups){
res = ccf(d[,occup], d$gss_m, lag = 10, plot=F)
res_df = do.call(rbind, Map(data.frame, lag=res$lag, acf=res$acf))
max_lag = res_df$lag[which.max(res_df$acf)]
max_acf = max(res_df$acf)
max_lags = append(max_lags, max_lag)
max_acfs = append(max_acfs, max_acf)
}
max_lags
mean(max_lags)
max_lags_2 = c()
max_acfs_2 = c()
for (occup in filtered_occups){
res = ccf(d[,occup], occup_stats[,occup], lag = 10, plot=F)
res_df = do.call(rbind, Map(data.frame, lag=res$lag, acf=res$acf))
max_lag = res_df$lag[which.max(res_df$acf)]
max_acf = max(res_df$acf)
max_lags_2 = append(max_lags_2, max_lag)
max_acfs_2 = append(max_acfs_2, max_acf)
}
max_lags_2
mean(max_lags_2)
max_lags_3
mean(max_lags_3)
0.3684211*2
mean(max_acfs_3)
max_acfs_3
mean(max_acfs_3)
?ccf
?acf
max_lags_3
mean(max_lags_3)
mean(max_lags_2)
mean(max_lags)
mean(max_lags)
mean(max_lags_3)
mean(max_acfs_3)
mean(max_acfs)
mean(max_lags_2)
mean(max_acfs_2)
?mutate
library(psych)
gss = read.table("gss7221_r1b.dta")
library(readr)
library(tidyverse)
gss = haven::read_dta("gss7221_r1b.dta")
View(gss)
View(gss)
mean(gss$fehome)
gss$fehome
mean(gss$fehome, na.rm=TRUE)
factor(gss$fehome)
gss$fehome_r = dplyr::recode(gss$fehome,
"1" = 0, "2"=1)
gss$fehome_r = car::recode(gss$fehome,
"c(1) = 0; c(2)=1")
mean$fehome_r
gss$fehome_r
mean(gss$fehome_r,na.rm=T)
describe(gss$fehome_r)
gender <- subset(gss, select = c(id, year, fehome, fework, fepres, fepol,
fefam, fehelp, fechld,fepresch, age, sex, educ, partyid))
write.csv(gender, "gender.csv")
gender = read.csv(gender)
gender = read.csv("gender.csv")
View(gender)
View(gender)
gender
gender = read.csv("gender.csv")
gender =
gender$fehome = car::recode(gender$fehome,
"1" = 0,
"2"=1)
gender =
gender$fehome = dplyr::recode(gender$fehome,
"1" = 0,
"2"=1)
mean(gender$fehome, rm.na = T)
mean(gender$fehome, na.rm = T)
gender$fehome
gender = read.csv("gender.csv")
mean(gender$fehome, na.rm = T)
gender$fehome = dplyr::recode(gender$fehome,
"1" = 0,
"2" = 1)
mean(gender$fehome, na.rm = T)
gender = read.csv("gender.csv")
mean(gender$fehome, na.rm = T)
gender = gener %>%
mutate(fehome = recode(fehome, "1" = 0, "2" = 1))
gender = read.csv("gender.csv")
gender = gender %>%
mutate(fehome = recode(fehome, "1" = 0, "2" = 1))
gender = gender %>%
mutate(fehome = dplyr::recode(fehome, "1" = 0, "2" = 1))
gender = read.csv("gender.csv")
gender = gender %>%
mutate(fehome = dplyr::recode(fehome, "1" = 0, "2" = 1))
mean(gender$fehome, na.rm = T)
gender = read.csv("gender.csv")
gender = gender %>%
mutate(fehome = dplyr::recode(fehome, "1" = -.5, "2" = .5)) %>%
mutate(fework = dplyr::recode(fework, "1" = .5, "2" = -.5)) %>%
mutate(fepres = dplyr::recode(fepres, "1" = .5, "2" = -.5)) %>%
mutate(fepol = dplyr::recode(fepol, "1" = -.5, "2" = .5)) %>%
mutate(fefam = dplyr::recode(fefam, "1" = -1.5, "2" = -.5, "3" = .5, "4" = 1.5)) %>%
mutate(fehelp = dplyr::recode(fehelp, "1" = -1.5, "2" = -.5, "3" = .5, "4" = 1.5)) %>%
mutate(fechld = dplyr::recode(fechld, "1" = 1.5, "2" = .5, "3" = -.5, "4" = -1.5)) %>%
mutate(fepresch = dplyr::recode(fepresch, "1" = -1.5, "2" = -.5, "3" = .5, "4" = 1.5))
mean(gender$fehome, na.rm = T)
str(gender[3:10])
View(gender)
View(gender)
gender[1:11] <- lapply(gender[1:11], as.numeric)
describe(gender[3:10])
sapply(gender[3:10], function(cl) list(means=mean(cl,na.rm=TRUE), sds=sd(cl,na.rm=TRUE)))
sapply(gender[3:11], function(cl) list(means=mean(cl,na.rm=TRUE), sds=sd(cl,na.rm=TRUE)))
0.1361999+2.5
year <- gender %>% group_by(YEAR) %>% summarize(fehome = mean(FEHOME, na.rm = TRUE),
fework = mean(FEWORK, na.rm = TRUE),
fepres = mean(FEPRES, na.rm = TRUE),
fepol = mean(FEPOL, na.rm = TRUE),
fefam = mean(FEFAM, na.rm = TRUE),
fehelp = mean(FEHELP, na.rm = TRUE),
fechld = mean(FECHLD, na.rm = TRUE),
fepresch = mean(FEPRESCH, na.rm = TRUE))
year <- gender %>% group_by(year) %>% summarize(fehome = mean(fehome, na.rm = TRUE),
fework = mean(fework, na.rm = TRUE),
fepres = mean(fepres, na.rm = TRUE),
fepol = mean(fepol, na.rm = TRUE),
fefam = mean(fefam, na.rm = TRUE),
fehelp = mean(fehelp, na.rm = TRUE),
fechld = mean(fechld, na.rm = TRUE),
fepresch = mean(fepresch, na.rm = TRUE))
year$sum1 <- rowMeans(year[2:5], na.rm = TRUE)
year$sum2 <- rowMeans(year[6:9], na.rm = TRUE)
year$sum_total <- rowMeans(year[10:11], na.rm = TRUE)
write.csv(year, "gss.csv")
write.csv(year, "gss_sum.csv")
View(year)
View(year)
View(year)
d1 = read.csv("attitude.csv")
d2 = read.csv("occups_difs.csv", skip=1)
d2 = d2 %>% rename(year = occup)
d2 = d2[d2$year > 1970, ]
d1 = d1[d1$year < 2010, ]
filtered_occups = c('accountant', 'architect', 'artist', 'athlete', 'attendant','author', 'baker', 'broker', 'carpenter', 'cashier', 'clergy','clerical', 'clerk', 'conductor', 'cook', 'dancer', 'dentist','designer', 'driver', 'economist', 'engineer', 'farmer','gardener', 'housekeeper', 'laborer', 'librarian', 'mathematician','midwife', 'musician', 'nurse', 'official', 'operator','photographer', 'pilot', 'police', 'porter', 'professor','psychologist', 'retired', 'sailor', 'scientist', 'secretary','soldier', 'student', 'tailor', 'teacher')
d = d2[,c("year",filtered_occups)]
lag_df = lag_df[(lag_df$max_lag >= -5) & (lag_df$max_lag <= 5),]
mean(lag_df$max_lag)
mean(lag_df$max_acf)
d3 = read.csv("IPUMS.csv") %>% janitor::clean_names()
d3 = d3[d3$sex == 1,] %>% select(-sex, -x) %>% rename(occup = single_words)
d3 = d3[d3$occup %in% filtered_occups,]
occup_stats = d3 %>% pivot_wider(
id_cols = year,
names_from = occup,
values_from = percent)
write.csv(occup_stats, "occup_stats.csv")
occup_stats = occup_stats[occup_stats$year %in% d$year,]
occup_na = c("dancer", "dentist", "designer", "gardener", "musician", "porter", "professor", "retired")
occup_stats = occup_stats %>% select(!all_of(occup_na))
occup_stats$occup_m = rowMeans(occup_stats[,2:39], na.rm = T)
write.csv(occup_stats, "occup_stats.csv")
d = d %>% select(!all_of(occup_na))
d$occup_m = rowMeans(d2[,2:39])
d$gss_m = d1$attitude
max_lags = c()
max_acfs = c()
filtered_occups = filtered_occups[!filtered_occups %in% occup_na]
for (occup in filtered_occups){
res = ccf(d[,occup], d$gss_m, lag = 10, plot=F)
res_df = do.call(rbind, Map(data.frame, lag=res$lag, acf=res$acf))
max_lag = res_df$lag[which.max(res_df$acf)]
max_acf = max(res_df$acf)
max_lags = append(max_lags, max_lag)
max_acfs = append(max_acfs, max_acf)
}
max_lags
mean(max_lags)
max_acfs
mean(max_acfs)
lag_df = do.call(rbind, Map(data.frame, occup=filtered_occups, max_lag=max_lags, max_acf=max_acfs))
write.csv(lag_df, "lag_df.csv")
max_lags_2 = c()
max_acfs_2 = c()
for (occup in filtered_occups){
res = ccf(d[,occup], occup_stats[,occup], lag = 10, plot=F)
res_df = do.call(rbind, Map(data.frame, lag=res$lag, acf=res$acf))
max_lag = res_df$lag[which.max(res_df$acf)]
max_acf = max(res_df$acf)
max_lags_2 = append(max_lags_2, max_lag)
max_acfs_2 = append(max_acfs_2, max_acf)
}
max_lags_2
mean(max_lags_2)
max_acfs_2
mean(max_acfs_2)
lag_df_2 = do.call(rbind, Map(data.frame, occup=filtered_occups, max_lag=max_lags_2, max_acf=max_acfs_2))
write.csv(lag_df, "lag_df_2.csv")
max_lags_3 = c()
max_acfs_3 = c()
for (occup in filtered_occups){
res = ccf(occup_stats[,occup], d$gss_m, lag = 10, plot=F)
res_df = do.call(rbind, Map(data.frame, lag=res$lag, acf=res$acf))
max_lag = res_df$lag[which.max(res_df$acf)]
max_acf = max(res_df$acf)
max_lags_3 = append(max_lags_3, max_lag)
max_acfs_3 = append(max_acfs_3, max_acf)
}
max_lags_3
mean(max_lags_3)
max_acfs_3
mean(max_acfs_3)
lag_df_3 = do.call(rbind, Map(data.frame, occup=filtered_occups, max_lag=max_lags_3, max_acf=max_acfs_3))
ccf(d[,"nurse"], d$gss_m, lag = 10, plot=T)
ccf(d[,"teacher"], d$gss_m, lag = 10, plot=T)
kde(max_lags)
qplot(max_lags)
ccf(d[,"teacher"], d$gss_m, lag = 10, plot=T)
qplot(max_lags)
qplot(max_lags, xlab="TEST")
?qplot
hist(max_lags)
hist(max_lags, break=1)
hist(max_lags, breaks =1)
hist(max_lags, bins=1)
hist(max_lags, bin=1)
?hist
hist(max_lags, freq=F)
?hist
hist(max_lags, freq=T)
?hist
hist(max_lags, freq=T, breaks=seq(-10, 10))
hist(max_lags, freq=T, breaks=seq(-10, 11))
hist(max_lags, freq=T, breaks=seq(-10, 10, 1))
# ccf(d[,"teacher"], d$gss_m, lag = 10, plot=T)
hist(max_lags, freq=T, breaks=seq(-10, 10, 1),
xlab="Lag with the maximum correlation coefficient",
ylab="Frequency (%)",
main="Cross-lag correlate Linguistic gender bias (X+t) v.s. gender role attitude")
# ccf(d[,"teacher"], d$gss_m, lag = 10, plot=T)
hist(max_lags, freq=T, breaks=seq(-10, 10, 1),
xlab="Lag with the maximum correlation coefficient",
ylab="Frequency (%)",
main="Cross-lag correlate linguistic gender bias (X+t) \n v.s. gender role attitude (Y)")
hist(max_lags_2, freq=T, breaks=seq(-10, 10, 1),
xlab="Lag with the maximum correlation coefficient",
ylab="Frequency (%)",
main="Cross-lag correlate linguistic gender bias (X+t) \n v.s. gender occupation difference (Y)")
hist(max_lags_3, freq=T, breaks=seq(-10, 10, 1),
xlab="Lag with the maximum correlation coefficient",
ylab="Frequency (%)",
main="Cross-lag correlate gender occupation difference (X+t) \n v.s. gender role attitude (Y)")
cor(d$gss_m, d$occup_m)
cor(d$gss_m, occup_stats$occup_m)
cor(d$occp_m, d$occup_stats$occup_m)
cor(d$ocucp_m, d$occup_stats$occup_m)
cor(d$ocucp_m, occup_stats$occup_m)
cor(d$occup_m, occup_stats$occup_m)
